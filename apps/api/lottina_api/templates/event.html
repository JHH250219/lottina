{% extends "base.html" %}
{% block title %}{{ event.title or "Event" }} – lottina{% endblock %}

{% block content %}
{% set location = event.location %}
{% set categories = event.categories or [] %}

<section class="relative overflow-hidden bg-gradient-to-br from-[#0f2f2c] via-[#155240] to-[#8be84f] text-white pt-32 pb-16">
  <div class="absolute inset-0 opacity-20 pointer-events-none bg-[radial-gradient(circle_at_top,_rgba(255,255,255,0.35),_rgba(0,0,0,0))]"></div>
  <div class="relative z-10 max-w-5xl mx-auto px-6 lg:px-10 space-y-6">
    <a href="{{ url_for('suchergebnisse') }}" class="inline-flex items-center gap-2 text-sm text-white/80 hover:text-white">
      ← Zurück zur Übersicht
    </a>
    <div class="space-y-4">
      <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/10 text-xs uppercase tracking-[0.3em] font-semibold">
        Familien-Event
      </span>
      <h1 class="text-3xl md:text-4xl font-lottina font-bold leading-tight drop-shadow">
        {{ event.title or "Event ohne Titel" }}
      </h1>
      <div class="flex flex-wrap gap-3 text-sm text-white/85">
        {% if event.dt_start %}
          <span class="inline-flex items-center gap-2 px-3 py-1 rounded-2xl border border-white/30">
            {{ event.dt_start | smartdate }}
          </span>
        {% endif %}
        {% if event.dt_end and event.dt_end.date() != event.dt_start.date() %}
          <span class="inline-flex items-center gap-2 px-3 py-1 rounded-2xl border border-white/30">
            bis {{ event.dt_end | smartdate }}
          </span>
        {% endif %}
        {% if event.is_free %}
          <span class="inline-flex items-center gap-2 px-3 py-1 rounded-2xl border border-white/30 text-white">
            Kostenlos
          </span>
        {% elif event.price_value %}
          <span class="inline-flex items-center gap-2 px-3 py-1 rounded-2xl border border-white/30">
            {{ "%.2f"|format(event.price_value or 0) }} {{ event.currency or "EUR" }}
          </span>
        {% endif %}
        {% if event.source_url %}
          <a href="{{ event.source_url }}" target="_blank" rel="noopener" class="inline-flex items-center gap-2 px-3 py-1 rounded-2xl border border-white/30 hover:bg-white/10 transition text-white">
            Zur Veranstalterseite
          </a>
        {% endif %}
      </div>
    </div>
  </div>
</section>

<section class="bg-[#f6fbf8]">
  <div class="max-w-6xl mx-auto px-6 lg:px-10 py-12 grid gap-8 lg:grid-cols-[minmax(0,2fr)_1fr]">
    <div class="space-y-6">
      {% if event.image %}
        <div class="rounded-3xl overflow-hidden border border-lottina-primary/10 shadow">
          <img src="{{ event.image }}" alt="{{ event.title }}" class="w-full h-72 object-cover">
        </div>
      {% endif %}

      {% if categories %}
        <div class="flex flex-wrap gap-2 text-xs text-lottina-primary">
          {% for cat in categories %}
            <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-lottina-primary/5 border border-lottina-primary/15">
              {{ cat.name }}
            </span>
          {% endfor %}
        </div>
      {% endif %}

      {% if event.description %}
        <article class="rounded-3xl border border-lottina-primary/10 bg-white p-6 shadow text-sm leading-relaxed text-lottina-primary/80">
          {{ event.description | safe }}
        </article>
      {% endif %}
    </div>

    <aside class="space-y-5">
      <div class="rounded-3xl border border-lottina-primary/10 bg-white p-5 shadow space-y-4 text-sm text-lottina-primary">
        <h2 class="text-lg font-semibold text-lottina-primary">Kurzinfo</h2>
        <dl class="space-y-3">
          {% if event.dt_start %}
            <div>
              <dt class="text-xs uppercase tracking-[0.3em] text-lottina-primary/60">Datum</dt>
              <dd class="font-semibold">{{ event.dt_start | smartdate }}</dd>
            </div>
          {% endif %}
          {% if event.dt_start and event.dt_end %}
            <div>
              <dt class="text-xs uppercase tracking-[0.3em] text-lottina-primary/60">Zeit</dt>
              <dd>{{ event.dt_start.strftime("%H:%M") }} – {{ event.dt_end.strftime("%H:%M") }}</dd>
            </div>
          {% endif %}
          {% if location %}
            <div>
              <dt class="text-xs uppercase tracking-[0.3em] text-lottina-primary/60">Ort</dt>
              <dd class="font-semibold">{{ location.name or "Ort folgt" }}</dd>
              {% if location.address %}
                <p class="text-xs text-lottina-primary/60">{{ location.address }}</p>
              {% endif %}
              {% if location.city %}
                <p class="text-xs text-lottina-primary/60">{{ location.city }}</p>
              {% endif %}
            </div>
          {% endif %}
          {% if event.price_value %}
            <div>
              <dt class="text-xs uppercase tracking-[0.3em] text-lottina-primary/60">Preis</dt>
              <dd>{{ "%.2f"|format(event.price_value or 0) }} {{ event.currency or "EUR" }}</dd>
            </div>
          {% elif event.is_free %}
            <div>
              <dt class="text-xs uppercase tracking-[0.3em] text-lottina-primary/60">Preis</dt>
              <dd>Kostenlos</dd>
            </div>
          {% endif %}
        </dl>
      </div>
    </aside>
  </div>
</section>
{% endblock %}
